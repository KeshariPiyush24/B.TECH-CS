-- QUERY-1
SELECT
  COUNT(*) AS Total__Students
FROM
  STUDENT;

-- QUERY-2
SELECT
  ROUND(AVG(GPA), 2) AS avg_GPA
FROM
  STUDENT;

-- QUERY-3
SELECT
  MAX(GPA) AS max_GPA,
  MIN(GPA) AS min_GPA
FROM
  STUDENT;

-- QUERY-4
SELECT
  COUNT(*)
FROM
  STUDENT
WHERE
  GPA >= 3.7;

-- QUERY-5
SELECT
  MAX(GPA) AS MAX_GPA,
  MIN(GPA) AS MIN_GPA,
  ROUND(AVG(GPA), 2) AS AVG_GPA,
  SUM(GPA) AS TOTAL_GPA
FROM
  STUDENT;

-- QUERY-6
SELECT
  COUNT(DISTINCT cNAME) AS TOTAL_COLLEGES
FROM
  APPLY;

-- QUERY-7
SELECT
  COUNT(DISTINCT MAJOR) AS TOTAL_MAJORS
FROM
  APPLY;

-- QUERY-8
SELECT
  COUNT(*)
FROM
  APPLY;

-- QUERY-9
SELECT
  AVG(GPA)
FROM
  APPLY;

-- QUERY-10
SELECT
  COUNT(*)
FROM
  APPLY
WHERE
  DECISION = 'Y';

-- QUERY-11
SELECT
  COUNT(*)
FROM
  STUDENT
WHERE
  GPA > 3.4
  AND SIZEHS > 1000;

-- QUERY-12
SELECT
  COUNT(*)
FROM
  APPLY
WHERE
  MAJOR = 'marine biology';

-- QUERY-13
SELECT
  DECISION,
  COUNT(*) AS COUNT
FROM
  APPLY
GROUP BY
  DECISION;

-- QUERY-14
SELECT
  MAJOR,
  COUNT(SID) AS NO_OF_APPLICATIONS
FROM
  APPLY
GROUP BY
  MAJOR;

-- QUERY-15
SELECT
  CNAME,
  COUNT(*) AS NO_OF_APPLICATIONS
FROM
  APPLY
GROUP BY
  CNAME;

-- QUERY-16
SELECT
  CNAME,
  MAJOR,
  COUNT(*) AS NO_OF_APPLICATIONS
FROM
  APPLY
GROUP BY
  CNAME,
  MAJOR
ORDER BY
  CNAME,
  MAJOR;

-- QUERY-17
SELECT
  CNAME,
  MAJOR,
  COUNT(*) AS NO_OF_APPLICATIONS
FROM
  APPLY
GROUP BY
  CNAME,
  MAJOR
HAVING
  COUNT(*) >= 2
ORDER BY
  CNAME,
  MAJOR;

-- QUERY-18
SELECT
  CNAME,
  COUNT(DISTINCT SID) AS NO_OF_APPLICANTS
FROM
  APPLY
GROUP BY
  CNAME
HAVING
  COUNT(DISTINCT SID) >= 3;

-- QUERY-19
SELECT
  STATE,
  COUNT(*) AS COLLEGE_COUNT
FROM
  COLLEGE
GROUP BY
  STATE;

-- QUERY-20
SELECT
  SNAME
FROM
  STUDENT
GROUP BY
  SNAME
HAVING
  COUNT(*) > 1;

-- QUERY-21
SELECT
  STUDENT.SID,
  SNAME,
  COUNT(APPLY.SID) AS NO_OF_APPLICATIONS
FROM
  STUDENT
  LEFT JOIN APPLY ON STUDENT.SID = APPLY.SID
GROUP BY
  STUDENT.SID,
  SNAME
ORDER BY
  SNAME;

-- QUERY-22
SELECT
  STUDENT.SID,
  SNAME,
  COUNT(APPLY.SID) AS NO_OF_APPLICATIONS
FROM
  STUDENT
  LEFT JOIN APPLY ON STUDENT.SID = APPLY.SID
GROUP BY
  STUDENT.SID,
  SNAME
HAVING
  COUNT(APPLY.SID) >= 3
ORDER BY
  SNAME;

-- QUERY-23
SELECT
  STUDENT.SID,
  SNAME,
  COUNT(APPLY.SID) AS NO_OF_APPLICATIONS
FROM
  STUDENT
  LEFT JOIN APPLY ON STUDENT.SID = APPLY.SID
GROUP BY
  STUDENT.SID,
  SNAME
HAVING
  COUNT(APPLY.SID) = 0
ORDER BY
  SNAME;

-- QUERY-24
SELECT
  CNAME,
  MAX(GPA),
  ROUND(AVG(GPA), 2) AS AVG_GPA,
  MIN(GPA)
FROM
  STUDENT NATURAL
  JOIN APPLY
GROUP BY
  CNAME;

-- QUERY-25
SELECT
  GPA,
  COUNT(SID)
FROM
  STUDENT
GROUP BY
  GPA
ORDER BY
  GPA;

-- QUERY-26
SELECT
  MAJOR,
  SUM(
    CASE
      WHEN DECISION = 'Y' THEN 1
      ELSE 0
    END
  ) AS NO_OF_APPLICATIONS_ACCEPTED,
  SUM(
    CASE
      WHEN DECISION = 'N' THEN 1
      ELSE 0
    END
  ) AS NO_OF_APPLICATIONS_REJECTED
FROM
  APPLY
GROUP BY
  MAJOR;

-- QUERY-27
SELECT
  CNAME,
  ROUND(
    SUM(
      CASE
        WHEN DECISION = 'Y' THEN 1
        ELSE 0
      END
    ) / COUNT(*),
    2
  ) AS ACCEPTANCE_RATE
FROM
  APPLY
GROUP BY
  CNAME;